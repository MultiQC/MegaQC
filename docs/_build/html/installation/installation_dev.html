

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MegaQC installation: Development &mdash; MegaQC 0.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/megaqc_style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MegaQC
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">MegaQC</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">MegaQC API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MegaQC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MegaQC installation: Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/installation/installation_dev.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="megaqc-installation-development">
<h1>MegaQC installation: Development<a class="headerlink" href="#megaqc-installation-development" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>You will need:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nodejs.org/en/download/">node</a></p></li>
<li><p><a class="reference external" href="https://www.python.org/downloads/">Python 3</a></p></li>
</ul>
</div>
<div class="section" id="clone-the-repo">
<h2>1. Clone the repo<a class="headerlink" href="#clone-the-repo" title="Permalink to this headline">¶</a></h2>
<p>If you’re doing development work, you need access to the source code</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone git@github.com:ewels/MegaQC.git
</pre></div>
</div>
</div>
<div class="section" id="install-the-python-into-a-virtual-environment">
<h2>2. Install the Python into a virtual environment<a class="headerlink" href="#install-the-python-into-a-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>You should do your development in a virtual environment. You also need
to install MegaQC and all its dependencies there:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> MegaQC
python3 -m venv venv
<span class="nb">source</span> venv/bin/activate
pip install -e .<span class="o">[</span>dev<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="enable-development-mode">
<h2>3. Enable development mode:<a class="headerlink" href="#enable-development-mode" title="Permalink to this headline">¶</a></h2>
<p>Setting this bash variable runs MegaQC in development mode. This means
that it will show full Python exception tracebacks in the web browser as
well as additional Flask plugins which help with debugging and
performance testing.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">FLASK_DEBUG</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="section" id="set-up-the-database">
<h2>4. Set up the database<a class="headerlink" href="#set-up-the-database" title="Permalink to this headline">¶</a></h2>
<p>Running this command creates an empty SQLite MegaQC database file in the
installation directory called <code class="docutils literal notranslate"><span class="pre">megaqc.db</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>megaqc initdb
</pre></div>
</div>
</div>
<div class="section" id="start-megaqc">
<h2>5. Start megaqc<a class="headerlink" href="#start-megaqc" title="Permalink to this headline">¶</a></h2>
<p>Start MegaQC:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>megaqc run
</pre></div>
</div>
<p>You will have to run the rest of these commands <strong>in another terminal
window</strong>, because <code class="docutils literal notranslate"><span class="pre">megaqc</span> <span class="pre">run</span></code> blocks the terminal.</p>
</div>
<div class="section" id="setup-your-access-key">
<h2>6. Setup your access key<a class="headerlink" href="#setup-your-access-key" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Login to MegaQC in your browser by browsing to
<a class="reference external" href="http://localhost:5000/register/">http://localhost:5000/register/</a> (the port might differ, it will
depend on what was output in the <code class="docutils literal notranslate"><span class="pre">megaqc</span> <span class="pre">run</span></code> stage previously</p></li>
<li><p>Once registered, visit <a class="reference external" href="http://localhost:5000/users/multiqc_config">http://localhost:5000/users/multiqc_config</a> and
follow the instructions there to configure your access token in
<code class="docutils literal notranslate"><span class="pre">~/.multiqc_config.yaml</span></code>.</p></li>
<li><p>Note: if you you’d rather not pollute your home directory, you can
instead name the file <code class="docutils literal notranslate"><span class="pre">multiqc_config.yaml</span></code> and place it in the
current (MegaQC) directory. However, you will then have to run
<code class="docutils literal notranslate"><span class="pre">megaqc</span> <span class="pre">upload</span></code> from that directory each time</p></li>
</ul>
</div>
<div class="section" id="load-test-data">
<h2>7. Load test data<a class="headerlink" href="#load-test-data" title="Permalink to this headline">¶</a></h2>
<p>In order to develop new features you need some data to test it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/TMiguelT/1000gFastqc
<span class="k">for</span> report in <span class="k">$(</span>find 1000gFastqc -name <span class="s1">&#39;*.json&#39;</span><span class="k">)</span>
    <span class="k">do</span> megaqc upload <span class="nv">$report</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="install-the-javascript-and-start-compiling">
<h2>8. Install the JavaScript and start compiling<a class="headerlink" href="#install-the-javascript-and-start-compiling" title="Permalink to this headline">¶</a></h2>
<p>This command will run until you cancel it, but will ensure that any
changes to the JavaScript are compiled instantly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install
npm run watch
</pre></div>
</div>
</div>
<div class="section" id="install-the-pre-commit-hooks">
<h2>9. Install the pre-commit hooks<a class="headerlink" href="#install-the-pre-commit-hooks" title="Permalink to this headline">¶</a></h2>
<p>MegaQC has a number of <a class="reference external" href="https://pre-commit.com/">pre-commit</a> hooks installed, which
automatically format and check your code before you commit. To set it
up, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pre-commit install
</pre></div>
</div>
<p>From now on, whenever you commit, each changed file will get processed
by the pre-commit hooks. If a file is changed by this process (because
your code style didn’t match the configuration), you’ll have to
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> the files again, and then re-run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>. If it lets
you write a commit message then everything has succeeded.</p>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>You should now have a fully functional MegaQC test server running,
accessible on your localhost at <a class="reference external" href="http://127.0.0.1:5000">http://127.0.0.1:5000</a></p>
<p>Now, head over to</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, MegaQC Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>